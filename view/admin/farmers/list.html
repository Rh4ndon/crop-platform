<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vegetable Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../../assets/sidebar.css">
    <script src="../../assets/alert.js"></script>
    <style>
        :root {
          --light-green: #7CB342;
          --green: #4CAF50;
          --dark-green: #388E3C;
          --yellow: #FFD54F;
          --orange: #FFA000;
          --gradient-sidebar: linear-gradient(180deg, var(--light-green), var(--green));
          --gradient-primary: linear-gradient(to right, var(--green), var(--yellow));
          --gradient-accent: linear-gradient(to right, var(--yellow), var(--orange));
        }
        .sidebar {
            background: var(--gradient-sidebar);
            min-height: 100vh;
        }
        .sidebar .nav-link {
            color: white;
            border-radius: 5px;
            margin-bottom: 5px;
            transition: all 0.3s;
        }
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            background-color: rgba(255,255,255,0.2);
            transform: translateX(5px);
        }
        .navbar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .card-icon {
            font-size: 2rem;
            color: var(--green);
        }
        .card-header-gradient {
            background: var(--gradient-primary);
            color: white;
        }
        .card-accent {
            border-top: 4px solid var(--orange);
        }
        .btn-primary {
            background-color: var(--green);
            border-color: var(--green);
        }
        .btn-primary:hover {
            background-color: var(--dark-green);
            border-color: var(--dark-green);
        }
        .btn-warning {
            background-color: var(--yellow);
            border-color: var(--yellow);
            color: #333;
        }
        .btn-warning:hover {
            background-color: var(--orange);
            border-color: var(--orange);
        }
        .text-primary {
            color: var(--green) !important;
        }
        .bg-light-green {
            background-color: rgba(124, 179, 66, 0.1);
        }
        .search-wrapper {
            position: relative;
        }
        .search-wrapper .bi-search {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        .search-wrapper input {
            padding-left: 38px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-2 sidebar p-0">
                <div class="text-center py-4">
                    <img src="../../assets/logo.png" alt="Logo" height="50">
                </div>
                <ul class="nav flex-column px-3">
                    <li class="nav-item">
                        <a class="nav-link" href="../dashboard.html">
                            <i class="bi bi-speedometer2 me-2"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../vegetables/list.html">
                            <i class="bi bi-tree me-2"></i> Crops
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="list.html">
                            <i class="bi bi-people me-2"></i> Students
                        </a>
                    </li>
                    <li class="nav-item mt-4">
                        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#logoutModal">
                            <i class="bi bi-box-arrow-left me-2"></i> Logout
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-10 ms-sm-auto px-0">
                <nav class="navbar navbar-expand-lg navbar-light bg-light-green">
                    <div class="container-fluid">
                        <span class="navbar-brand">Student Management</span>
                        <div class="d-flex align-items-center">
                            <span class="me-3" id="welcome-admin">Admin</span>
                            <script>
                                const firstName = sessionStorage.getItem('first_name');
                                const lastName = sessionStorage.getItem('last_name');
                                if (firstName && lastName) {
                                    document.getElementById('welcome-admin').textContent = `${firstName} ${lastName}`;
                                }
                            </script>
                            <img src="https://www.pngmart.com/files/21/Admin-Profile-Vector-PNG-Clipart.png" style="max-width: 50px;" class="rounded-circle" alt="Profile">
                        </div>
                    </div>
                </nav>
                
                <div class="container-fluid py-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        
                        <a href="add.html" class="btn btn-primary">
                            <i class="bi bi-plus-circle me-2"></i> Add New
                        </a>
                    </div>
                    
                    <div class="card shadow-sm border-0">
                        <div class="card-header card-header-gradient">
                            <h5 class="mb-0">Students List</h5>
                        </div>
                        <div class="card-body">
                            <!-- Search Bar -->
                            <div class="row mb-3">
                                <div class="col-md-6 col-lg-4">
                                    <div class="search-wrapper">
                                        <i class="bi bi-search"></i>
                                        <input type="text" 
                                               class="form-control" 
                                               id="searchInput" 
                                               placeholder="Search students...">
                                    </div>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="table table-hover" id="farmers-table">
                                    <thead>
                                        <tr>
                                            <th>ULI (Unique Learner Identifier)</th>
                                            <th>First Name</th>
                                            <th>Middle Name</th>
                                            <th>Last Name</th>
                                            <th>Gender</th>
                                            <th>Email</th>
                                            <th>Phone</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Farmer rows will be inserted here by JS -->
                                    </tbody>
                                </table>

                                <!-- Edit Farmer Modal -->
                                <div class="modal fade" id="editFarmerModal" tabindex="-1" aria-labelledby="editFarmerModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-xl">
                                        <form id="editFarmerForm" class="modal-content" enctype="multipart/form-data">
                                            <div class="modal-header card-header-gradient">
                                                <h5 class="modal-title text-white" id="editFarmerModalLabel">
                                                    <i class="bi bi-person-gear me-2"></i>Edit Student Information
                                                </h5>
                                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                                                <input type="hidden" id="editFarmerId" name="id">
                                                
                                                <!-- Section 1: Basic Information -->
                                                <div class="section-header">
                                                    <i class="bi bi-info-circle me-2"></i>1. Basic Information
                                                </div>
                                                <div class="row g-3 mb-3">
                                                    <div class="col-md-12">
                                                        <label for="editProfilePicture" class="form-label">Profile Picture</label>
                                                        <input type="file" accept="image/*" class="form-control" id="editProfilePicture" name="profile_picture">
                                                        <div class="form-text">Leave empty to keep current picture</div>
                                                        <div id="currentProfilePicture" class="mt-2"></div>
                                                    </div>
                                                </div>
                                                <div class="row g-3">
                                                    <div class="col-md-4">
                                                        <label for="editUli" class="form-label">ULI (Unique Learner Identifier)</label>
                                                        <input type="text" class="form-control" id="editUli" name="uli" readonly>
                                                        <div class="form-text">ULI is auto-generated and cannot be changed</div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editLastName" class="form-label">Last Name <span class="text-danger">*</span></label>
                                                        <input type="text" class="form-control" id="editLastName" name="last_name" required>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editFirstName" class="form-label">First Name <span class="text-danger">*</span></label>
                                                        <input type="text" class="form-control" id="editFirstName" name="first_name" required>
                                                    </div>
                                                </div>
                                                <div class="row g-3">
                                                    <div class="col-md-4">
                                                        <label for="editMiddleName" class="form-label">Middle Name</label>
                                                        <input type="text" class="form-control" id="editMiddleName" name="middle_name">
                                                    </div>
                                                </div>

                                                <!-- Section 2: Complete Permanent Mailing Address -->
                                                <div class="section-header">
                                                    <i class="bi bi-geo-alt me-2"></i>2. Complete Permanent Mailing Address
                                                </div>
                                                <div class="row g-3">
                                                    <div class="col-md-4">
                                                        <label for="editNumberStreet" class="form-label">Number, Street</label>
                                                        <input type="text" class="form-control" id="editNumberStreet" name="number_street">
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editBarangay" class="form-label">Barangay <span class="text-danger">*</span></label>
                                                        <input type="text" class="form-control" id="editBarangay" name="barangay" required>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editDistrict" class="form-label">District</label>
                                                        <input type="text" class="form-control" id="editDistrict" name="district">
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editCityMunicipality" class="form-label">City/Municipality <span class="text-danger">*</span></label>
                                                        <input type="text" class="form-control" id="editCityMunicipality" name="city_municipality" required>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editProvince" class="form-label">Province <span class="text-danger">*</span></label>
                                                        <input type="text" class="form-control" id="editProvince" name="province" required>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editRegion" class="form-label">Region</label>
                                                        <input type="text" class="form-control" id="editRegion" name="region">
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label for="editEmail" class="form-label">Email Address/Facebook Account</label>
                                                        <input type="email" class="form-control" id="editEmail" name="email">
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label for="editPhone" class="form-label">Contact No. <span class="text-danger">*</span></label>
                                                        <input type="tel" class="form-control" id="editPhone" name="phone" required>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label for="editNationality" class="form-label">Nationality</label>
                                                        <input type="text" class="form-control" id="editNationality" name="nationality" value="Filipino">
                                                    </div>
                                                </div>

                                                <!-- Section 3: Personal Information -->
                                                <div class="section-header">
                                                    <i class="bi bi-person me-2"></i>3. Personal Information
                                                </div>
                                                <div class="row g-3">
                                                    <div class="col-md-4">
                                                        <label class="form-label">3.1 Sex <span class="text-danger">*</span></label>
                                                        <div>
                                                            <div class="form-check form-check-inline">
                                                                <input class="form-check-input" type="radio" name="gender" id="editGenderMale" value="Male" required>
                                                                <label class="form-check-label" for="editGenderMale">Male</label>
                                                            </div>
                                                            <div class="form-check form-check-inline">
                                                                <input class="form-check-input" type="radio" name="gender" id="editGenderFemale" value="Female" required>
                                                                <label class="form-check-label" for="editGenderFemale">Female</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label">3.2 Civil Status</label>
                                                        <div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="radio" name="civil_status" id="editCivilSingle" value="Single">
                                                                <label class="form-check-label" for="editCivilSingle">Single</label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="radio" name="civil_status" id="editCivilMarried" value="Married">
                                                                <label class="form-check-label" for="editCivilMarried">Married</label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="radio" name="civil_status" id="editCivilWidower" value="Widower">
                                                                <label class="form-check-label" for="editCivilWidower">Widower</label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="radio" name="civil_status" id="editCivilSeparated" value="Separated">
                                                                <label class="form-check-label" for="editCivilSeparated">Separated</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label">3.3 Employment Status</label>
                                                        <div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="radio" name="employment_status" id="editEmployed" value="employed">
                                                                <label class="form-check-label" for="editEmployed">Employed</label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="radio" name="employment_status" id="editUnemployed" value="unemployed">
                                                                <label class="form-check-label" for="editUnemployed">Unemployed</label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="radio" name="employment_status" id="editSelfEmployed" value="self-employed">
                                                                <label class="form-check-label" for="editSelfEmployed">Self-employed</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Birth Information -->
                                                <div class="row g-3 mt-2">
                                                    <div class="col-md-4">
                                                        <label for="editBirthdate" class="form-label">3.4 Date of Birth <span class="text-danger">*</span></label>
                                                        <input type="date" class="form-control" id="editBirthdate" name="birthdate" required>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editAge" class="form-label">Age</label>
                                                        <input type="number" class="form-control" id="editAge" name="age" readonly>
                                                    </div>
                                                </div>

                                                <!-- Birthplace -->
                                                <div class="row g-3 mt-2">
                                                    <div class="col-md-4">
                                                        <label for="editBirthplaceCity" class="form-label">Birthplace - City/Municipality</label>
                                                        <input type="text" class="form-control" id="editBirthplaceCity" name="birthplace_city">
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editBirthplaceProvince" class="form-label">Province</label>
                                                        <input type="text" class="form-control" id="editBirthplaceProvince" name="birthplace_province">
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label for="editBirthplaceRegion" class="form-label">Region</label>
                                                        <input type="text" class="form-control" id="editBirthplaceRegion" name="birthplace_region">
                                                    </div>
                                                </div>

                                                <!-- Section 4: Educational Attainment -->
                                                <div class="section-header">
                                                    <i class="bi bi-mortarboard me-2"></i>3.5 Educational Attainment
                                                </div>
                                                <div class="row g-3">
                                                    <div class="col-md-6">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editNoGrade" value="no_grade">
                                                            <label class="form-check-label" for="editNoGrade">No Grade Completed/Pre-School</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editElementary" value="elementary">
                                                            <label class="form-check-label" for="editElementary">Elementary Level</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editElementaryGrad" value="elementary_grad">
                                                            <label class="form-check-label" for="editElementaryGrad">Elementary Graduate</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editHsGrad" value="hs_grad">
                                                            <label class="form-check-label" for="editHsGrad">High School Graduate</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editHsLevel" value="hs_level">
                                                            <label class="form-check-label" for="editHsLevel">High School Level</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editPostSecondary" value="post_secondary">
                                                            <label class="form-check-label" for="editPostSecondary">Post-Secondary Level/Graduate</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editCollegeLevel" value="college_level">
                                                            <label class="form-check-label" for="editCollegeLevel">College Level</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="education_level" id="editCollegeGrad" value="college_grad">
                                                            <label class="form-check-label" for="editCollegeGrad">College Graduate or Higher</label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Section 5: Classification -->
                                                <div class="section-header">
                                                    <i class="bi bi-list-check me-2"></i>4. Learner Classification
                                                </div>
                                                <div class="row g-3">
                                                    <div class="col-md-4">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editPwd" value="Persons with Disabilities">
                                                            <label class="form-check-label" for="editPwd">Persons with Disabilities (PWDs)</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editDisplaced" value="Displaced Worker">
                                                            <label class="form-check-label" for="editDisplaced">Displaced Worker (Local)</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editOfw" value="OFW">
                                                            <label class="form-check-label" for="editOfw">OFW</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editOfwDependent" value="OFW Dependent">
                                                            <label class="form-check-label" for="editOfwDependent">OFW Dependent</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editOfwRepatriate" value="OFW Repatriate">
                                                            <label class="form-check-label" for="editOfwRepatriate">OFW Repatriate</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editTrafficking" value="Victims/Survivors of Human Trafficking">
                                                            <label class="form-check-label" for="editTrafficking">Victims/Survivors of Human Trafficking</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editIndigenous" value="Indigenous People">
                                                            <label class="form-check-label" for="editIndigenous">Indigenous People</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editRebel" value="Rebel Returnees">
                                                            <label class="form-check-label" for="editRebel">Rebel Returnees</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editSoloParent" value="Solo Parent">
                                                            <label class="form-check-label" for="editSoloParent">Solo Parent</label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="classification" id="editOthers" value="Others">
                                                            <label class="form-check-label" for="editOthers">Others (specify)</label>
                                                        </div>
                                                        <input type="text" class="form-control mt-2" id="editClassificationOthers" name="classification_others_text" placeholder="Specify if Others" disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                <button type="submit" class="btn btn-primary">
                                                    <i class="bi bi-check-circle me-1"></i> Update Student
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>

                                <!-- View Farmer Modal -->
                                <div class="modal fade" id="viewFarmerModal" tabindex="-1" aria-labelledby="viewFarmerModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-xl">
                                        <div class="modal-content">
                                            <div class="modal-header card-header-gradient">
                                                <h5 class="modal-title text-white" id="viewFarmerModalLabel">
                                                    <i class="bi bi-person-badge me-2"></i>Student Details
                                                </h5>
                                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                                                <!-- Profile Header -->
                                                <div class="row mb-4">
                                                    <div class="col-md-3 text-center">
                                                        <div id="viewProfilePicture" class="mb-3">
                                                            <img src="" alt="Profile Picture" class="rounded-circle border" style="width: 150px; height: 150px; object-fit: cover;" id="viewProfileImage">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-9">
                                                        <h3 id="viewFullName" class="text-primary mb-2"></h3>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <p class="mb-1"><strong>ULI:</strong> <span id="viewUli" class="text-muted"></span></p>
                                                                <p class="mb-1"><strong>Gender:</strong> <span id="viewGender" class="text-muted"></span></p>
                                                                <p class="mb-1"><strong>Birthdate:</strong> <span id="viewBirthdate" class="text-muted"></span></p>
                                                                <p class="mb-1"><strong>Age:</strong> <span id="viewAge" class="text-muted"></span></p>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <p class="mb-1"><strong>Contact:</strong> <span id="viewPhone" class="text-muted"></span></p>
                                                                <p class="mb-1"><strong>Email:</strong> <span id="viewEmail" class="text-muted"></span></p>
                                                                <p class="mb-1"><strong>Nationality:</strong> <span id="viewNationality" class="text-muted"></span></p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Section 1: Basic Information -->
                                                <div class="section-header">
                                                    <i class="bi bi-info-circle me-2"></i>1. Basic Information
                                                </div>
                                                <div class="row g-3 mb-4">
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Last Name</label>
                                                        <p id="viewLastName" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">First Name</label>
                                                        <p id="viewFirstName" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Middle Name</label>
                                                        <p id="viewMiddleName" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                </div>

                                                <!-- Section 2: Complete Permanent Mailing Address -->
                                                <div class="section-header">
                                                    <i class="bi bi-geo-alt me-2"></i>2. Complete Permanent Mailing Address
                                                </div>
                                                <div class="row g-3 mb-4">
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Number, Street</label>
                                                        <p id="viewNumberStreet" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Barangay</label>
                                                        <p id="viewBarangay" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">District</label>
                                                        <p id="viewDistrict" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">City/Municipality</label>
                                                        <p id="viewCityMunicipality" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Province</label>
                                                        <p id="viewProvince" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Region</label>
                                                        <p id="viewRegion" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                </div>

                                                <!-- Section 3: Personal Information -->
                                                <div class="section-header">
                                                    <i class="bi bi-person me-2"></i>3. Personal Information
                                                </div>
                                                <div class="row g-3 mb-4">
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Civil Status</label>
                                                        <p id="viewCivilStatus" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Employment Status</label>
                                                        <p id="viewEmploymentStatus" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                </div>

                                                <!-- Birth Information -->
                                                <div class="row g-3 mb-4">
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Birthplace - City/Municipality</label>
                                                        <p id="viewBirthplaceCity" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Birthplace - Province</label>
                                                        <p id="viewBirthplaceProvince" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="form-label fw-bold">Birthplace - Region</label>
                                                        <p id="viewBirthplaceRegion" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                </div>

                                                <!-- Section 4: Educational Attainment -->
                                                <div class="section-header">
                                                    <i class="bi bi-mortarboard me-2"></i>3.5 Educational Attainment
                                                </div>
                                                <div class="row g-3 mb-4">
                                                    <div class="col-12">
                                                        <p id="viewEducationLevel" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                </div>

                                                <!-- Section 5: Classification -->
                                                <div class="section-header">
                                                    <i class="bi bi-list-check me-2"></i>4. Learner Classification
                                                </div>
                                                <div class="row g-3">
                                                    <div class="col-12">
                                                        <p id="viewClassification" class="form-control-plaintext border-bottom"></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                                <button type="button" class="btn btn-primary" id="printStudentBtn">
                                                    <i class="bi bi-printer me-1"></i> Print
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Delete Confirmation Modal -->
                                <div class="modal fade" id="deleteFarmerModal" tabindex="-1" aria-labelledby="deleteFarmerModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="deleteFarmerModalLabel">Confirm Delete</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                Are you sure you want to delete this farmer? This action cannot be undone.
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <script>
                                    // Handle delete button click
                                    document.querySelector('#farmers-table').addEventListener('click', function(e) {
                                        if (e.target.closest('.btn-danger') && !e.target.closest('.btn-edit')) {
                                            const btn = e.target.closest('.btn-danger');
                                            const farmerId = btn.getAttribute('data-id');
                                            
                                            // Set the farmer ID in the modal
                                            document.getElementById('confirmDeleteBtn').setAttribute('data-id', farmerId);
                                            
                                            // Show the delete confirmation modal
                                            var deleteModal = new bootstrap.Modal(document.getElementById('deleteFarmerModal'));
                                            deleteModal.show();
                                        }
                                    });

                                   // Handle confirm delete button click
                                    document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
                                        const farmerId = this.getAttribute('data-id');
                                        
                                        // Send delete request with proper JSON format
                                        fetch('../../../controllers/admin/delete-farmer.php', {
                                            method: 'POST',
                                            headers: {
                                                'Content-Type': 'application/json',
                                            },
                                            body: JSON.stringify({ id: farmerId })
                                        })
                                        .then(response => {
                                            // First check if response is OK
                                            if (!response.ok) {
                                                throw new Error('Network response was not ok');
                                            }
                                            return response.json();
                                        })
                                        .then(result => {
                                            if (result.success) {
                                                // Close the modal
                                                var deleteModal = bootstrap.Modal.getInstance(document.getElementById('deleteFarmerModal'));
                                                deleteModal.hide();
                                                
                                                
                                                // Show success message
                                                showAlert('Farmer deleted successfully.', 'success');

                                                setTimeout(() => {
                                                    // Reload the farmers list
                                                   window.location.reload();
                                                }, 3000);
                                            } else {
                                                showAlert(result.error || 'Failed to delete farmer.', 'danger');
                                            }
                                        })
                                        .catch(error => {
                                            console.error('Error:', error);
                                            showAlert('Error deleting farmer: ' + error.message, 'danger');
                                        });
                                    });


                                document.addEventListener('DOMContentLoaded', function() {
                                        // Fetch and render farmers
                                        function loadFarmers() {
                                                fetch('../../../controllers/admin/get-farmers.php')
                                                        .then(response => response.json())
                                                        .then(data => {
                                                                const tbody = document.querySelector('#farmers-table tbody');
                                                                tbody.innerHTML = '';
                                                                if (Array.isArray(data)) {
                                                                        data.forEach(farmer => {
                                                                                const tr = document.createElement('tr');
                                                                                tr.innerHTML = `
                                                                                        <td>${farmer.uli}</td>
                                                                                        <td>${farmer.first_name}</td>
                                                                                        <td>${farmer.middle_name}</td>
                                                                                        <td>${farmer.last_name}</td>
                                                                                        <td>${farmer.gender}</td>
                                                                                        <td>${farmer.email}</td>
                                                                                        <td>${farmer.phone}</td>
                                                                                        <td>
                                                                                            <button class="btn btn-sm btn-info me-2 btn-view" 
                                                                                                        data-id="${farmer.id}" 
                                                                                                        data-uli="${farmer.uli || ''}"
                                                                                                        data-first_name="${farmer.first_name || ''}" 
                                                                                                        data-middle_name="${farmer.middle_name || ''}"
                                                                                                        data-last_name="${farmer.last_name || ''}"
                                                                                                        data-number_street="${farmer.number_street || ''}"
                                                                                                        data-barangay="${farmer.barangay || ''}"
                                                                                                        data-district="${farmer.district || ''}"
                                                                                                        data-city_municipality="${farmer.city_municipality || ''}"
                                                                                                        data-province="${farmer.province || ''}"
                                                                                                        data-region="${farmer.region || ''}"
                                                                                                        data-email="${farmer.email || ''}" 
                                                                                                        data-phone="${farmer.phone || ''}" 
                                                                                                        data-gender="${farmer.gender || ''}"
                                                                                                        data-nationality="${farmer.nationality || ''}"
                                                                                                        data-civil_status="${farmer.civil_status || ''}"
                                                                                                        data-employment_status="${farmer.employment_status || ''}"
                                                                                                        data-birthdate="${farmer.birthdate || ''}"
                                                                                                        data-birthplace_city="${farmer.birthplace_city || ''}"
                                                                                                        data-birthplace_province="${farmer.birthplace_province || ''}"
                                                                                                        data-birthplace_region="${farmer.birthplace_region || ''}"
                                                                                                        data-education_level="${farmer.education_level || ''}"
                                                                                                        data-classification="${farmer.classification || ''}"
                                                                                                        data-profile_picture="${farmer.profile_picture || ''}">
                                                                                                    <i class="bi bi-send-fill"></i>
                                                                                                </button>
                                                                                                <button class="btn btn-sm btn-warning me-2 btn-edit" 
                                                                                                        data-id="${farmer.id}" 
                                                                                                        data-uli="${farmer.uli || ''}"
                                                                                                        data-first_name="${farmer.first_name || ''}" 
                                                                                                        data-middle_name="${farmer.middle_name || ''}"
                                                                                                        data-last_name="${farmer.last_name || ''}"
                                                                                                        data-number_street="${farmer.number_street || ''}"
                                                                                                        data-barangay="${farmer.barangay || ''}"
                                                                                                        data-district="${farmer.district || ''}"
                                                                                                        data-city_municipality="${farmer.city_municipality || ''}"
                                                                                                        data-province="${farmer.province || ''}"
                                                                                                        data-region="${farmer.region || ''}"
                                                                                                        data-email="${farmer.email || ''}" 
                                                                                                        data-phone="${farmer.phone || ''}" 
                                                                                                        data-gender="${farmer.gender || ''}"
                                                                                                        data-nationality="${farmer.nationality || ''}"
                                                                                                        data-civil_status="${farmer.civil_status || ''}"
                                                                                                        data-employment_status="${farmer.employment_status || ''}"
                                                                                                        data-birthdate="${farmer.birthdate || ''}"
                                                                                                        data-birthplace_city="${farmer.birthplace_city || ''}"
                                                                                                        data-birthplace_province="${farmer.birthplace_province || ''}"
                                                                                                        data-birthplace_region="${farmer.birthplace_region || ''}"
                                                                                                        data-education_level="${farmer.education_level || ''}"
                                                                                                        data-classification="${farmer.classification || ''}"
                                                                                                        data-profile_picture="${farmer.profile_picture || ''}">
                                                                                                    <i class="bi bi-pencil"></i>
                                                                                                </button>
                                                                                                 
                                                                                                <button class="btn btn-sm btn-danger" data-id="${farmer.id}">
                                                                                                        <i class="bi bi-trash"></i>
                                                                                                </button>
                                                                                        </td>
                                                                                `;
                                                                                tbody.appendChild(tr);
                                                                        });
                                                                } else {
                                                                        tbody.innerHTML = `<tr><td colspan="6" class="text-center text-muted">No farmers found.</td></tr>`;
                                                                }
                                                        })
                                                        .catch(error => {
                                                                const tbody = document.querySelector('#farmers-table tbody');
                                                                tbody.innerHTML = `<tr><td colspan="6" class="text-center text-danger">Error loading farmers.</td></tr>`;
                                                        });
                                        }

                                        loadFarmers();

                                       // Handle edit button click
                                        document.querySelector('#farmers-table').addEventListener('click', function(e) {
                                            if (e.target.closest('.btn-edit')) {
                                                const btn = e.target.closest('.btn-edit');
                                                
                                                // Basic Information
                                                document.getElementById('editFarmerId').value = btn.getAttribute('data-id');
                                                document.getElementById('editUli').value = btn.getAttribute('data-uli') || '';
                                                document.getElementById('editFirstName').value = btn.getAttribute('data-first_name') || '';
                                                document.getElementById('editMiddleName').value = btn.getAttribute('data-middle_name') || '';
                                                document.getElementById('editLastName').value = btn.getAttribute('data-last_name') || '';
                                                
                                                // Address Information
                                                document.getElementById('editNumberStreet').value = btn.getAttribute('data-number_street') || '';
                                                document.getElementById('editBarangay').value = btn.getAttribute('data-barangay') || '';
                                                document.getElementById('editDistrict').value = btn.getAttribute('data-district') || '';
                                                document.getElementById('editCityMunicipality').value = btn.getAttribute('data-city_municipality') || '';
                                                document.getElementById('editProvince').value = btn.getAttribute('data-province') || '';
                                                document.getElementById('editRegion').value = btn.getAttribute('data-region') || '';
                                                
                                                // Contact Information
                                                document.getElementById('editEmail').value = btn.getAttribute('data-email') || '';
                                                document.getElementById('editPhone').value = btn.getAttribute('data-phone') || '';
                                                document.getElementById('editNationality').value = btn.getAttribute('data-nationality') || 'Filipino';
                                                
                                                // Gender
                                                const gender = btn.getAttribute('data-gender');
                                                if (gender) {
                                                    document.querySelectorAll('input[name="gender"]').forEach(radio => {
                                                        radio.checked = radio.value === gender;
                                                    });
                                                }
                                                
                                                // Civil Status
                                                const civilStatus = btn.getAttribute('data-civil_status');
                                                if (civilStatus) {
                                                    document.querySelectorAll('input[name="civil_status"]').forEach(radio => {
                                                        radio.checked = radio.value === civilStatus;
                                                    });
                                                }
                                                
                                                // Employment Status
                                                const employmentStatus = btn.getAttribute('data-employment_status');
                                                if (employmentStatus) {
                                                    document.querySelectorAll('input[name="employment_status"]').forEach(radio => {
                                                        radio.checked = radio.value === employmentStatus;
                                                    });
                                                }
                                                
                                                // Birth Information
                                                const birthdate = btn.getAttribute('data-birthdate');
                                                if (birthdate) {
                                                    document.getElementById('editBirthdate').value = birthdate;
                                                    calculateEditAge();
                                                }
                                                
                                                // Birthplace
                                                document.getElementById('editBirthplaceCity').value = btn.getAttribute('data-birthplace_city') || '';
                                                document.getElementById('editBirthplaceProvince').value = btn.getAttribute('data-birthplace_province') || '';
                                                document.getElementById('editBirthplaceRegion').value = btn.getAttribute('data-birthplace_region') || '';
                                                
                                                // Education Level
                                                const educationLevel = btn.getAttribute('data-education_level');
                                                if (educationLevel) {
                                                    document.querySelectorAll('input[name="education_level"]').forEach(radio => {
                                                        radio.checked = radio.value === educationLevel;
                                                    });
                                                }
                                                
                                                // Classification
                                                const classification = btn.getAttribute('data-classification');
                                                if (classification) {
                                                    const classificationRadios = document.querySelectorAll('input[name="classification"]');
                                                    let found = false;
                                                    
                                                    classificationRadios.forEach(radio => {
                                                        if (radio.value === classification) {
                                                            radio.checked = true;
                                                            found = true;
                                                        }
                                                    });
                                                    
                                                    // If classification doesn't match any predefined values, use "Others"
                                                    if (!found && classification) {
                                                        document.getElementById('editOthers').checked = true;
                                                        document.getElementById('editClassificationOthers').disabled = false;
                                                        document.getElementById('editClassificationOthers').value = classification;
                                                    } else {
                                                        document.getElementById('editClassificationOthers').disabled = true;
                                                        document.getElementById('editClassificationOthers').value = '';
                                                    }
                                                }
                                                
                                                // Profile Picture
                                                const profilePicture = btn.getAttribute('data-profile_picture');
                                                const currentPictureDiv = document.getElementById('currentProfilePicture');
                                                if (profilePicture) {
                                                    currentPictureDiv.innerHTML = `
                                                        <small class="text-muted">Current Picture:</small><br>
                                                        <img src="../../../uploads/profiles/${profilePicture}" 
                                                            alt="Current Profile" 
                                                            style="max-width: 100px; max-height: 100px; object-fit: cover;" 
                                                            class="rounded border">
                                                    `;
                                                } else {
                                                    currentPictureDiv.innerHTML = '<small class="text-muted">No profile picture uploaded</small>';
                                                }
                                                
                                                // Show modal
                                                var editModal = new bootstrap.Modal(document.getElementById('editFarmerModal'));
                                                editModal.show();
                                            }
                                        });

                                        // Calculate age from birthdate
                                        function calculateEditAge() {
                                            const birthdate = document.getElementById('editBirthdate').value;
                                            if (birthdate) {
                                                const birthDate = new Date(birthdate);
                                                const today = new Date();
                                                let age = today.getFullYear() - birthDate.getFullYear();
                                                const monthDiff = today.getMonth() - birthDate.getMonth();
                                                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                                                    age--;
                                                }
                                                document.getElementById('editAge').value = age;
                                            }
                                        }

                                        // Add event listener for birthdate change
                                        document.getElementById('editBirthdate').addEventListener('change', calculateEditAge);

                                        // Handle "Others" classification
                                        document.getElementById('editOthers').addEventListener('change', function() {
                                            document.getElementById('editClassificationOthers').disabled = !this.checked;
                                            if (this.checked) {
                                                document.getElementById('editClassificationOthers').focus();
                                            }
                                        });

                                        // Also handle when other classification options are selected
                                        document.querySelectorAll('input[name="classification"]').forEach(radio => {
                                            radio.addEventListener('change', function() {
                                                if (this.id !== 'editOthers') {
                                                    document.getElementById('editClassificationOthers').disabled = true;
                                                    document.getElementById('editClassificationOthers').value = '';
                                                }
                                            });
                                        });

                                        // Handle "Others" classification
                                        document.getElementById('editOthers').addEventListener('change', function() {
                                            document.getElementById('editClassificationOthers').disabled = !this.checked;
                                            if (this.checked) {
                                                document.getElementById('editClassificationOthers').focus();
                                            }
                                        });

                                        // Also handle when other classification options are selected
                                        document.querySelectorAll('input[name="classification"]').forEach(radio => {
                                            radio.addEventListener('change', function() {
                                                if (this.id !== 'editOthers') {
                                                    document.getElementById('editClassificationOthers').disabled = true;
                                                    document.getElementById('editClassificationOthers').value = '';
                                                }
                                            });
                                        });

                                        // Handle form submit for update
                                        document.getElementById('editFarmerForm').addEventListener('submit', function(e) {
                                                e.preventDefault();
                                                const form = e.target;
                                                const formData = new FormData(form);
                                                fetch('../../../controllers/admin/update-farmer.php', {
                                                        method: 'POST',
                                                        body: formData
                                                })
                                                .then(response => response.json())
                                                .then(result => {
                                                        if (result.success) {
                                                                var editModal = bootstrap.Modal.getInstance(document.getElementById('editFarmerModal'));
                                                                editModal.hide();
                                                                loadFarmers();
                                                                showAlert('Farmer updated successfully.', 'success');
                                                        } else {
                                                                showAlert(result.message || 'Failed to update farmer.', 'danger');
                                                        }
                                                })
                                                .catch(() => {
                                                        showAlert('Error updating farmer.', 'danger');
                                                });
                                        });

                                        // Search functionality
                                        document.getElementById('searchInput').addEventListener('keyup', function() {
                                            const searchValue = this.value.toLowerCase();
                                            const tableRows = document.querySelectorAll('#farmers-table tbody tr');
                                            
                                            tableRows.forEach(row => {
                                                const firstName = row.cells[0]?.textContent.toLowerCase() || '';
                                                const lastName = row.cells[1]?.textContent.toLowerCase() || '';
                                                const email = row.cells[2]?.textContent.toLowerCase() || '';
                                                const phone = row.cells[3]?.textContent.toLowerCase() || '';
                                                const address = row.cells[4]?.textContent.toLowerCase() || '';
                                                
                                                const matchFound = firstName.includes(searchValue) || 
                                                                   lastName.includes(searchValue) || 
                                                                   email.includes(searchValue) || 
                                                                   phone.includes(searchValue) || 
                                                                   address.includes(searchValue);
                                                
                                                row.style.display = matchFound ? '' : 'none';
                                            });
                                        });

                                        // Handle view button click
                                        document.querySelector('#farmers-table').addEventListener('click', function(e) {
                                            if (e.target.closest('.btn-view')) {
                                                const btn = e.target.closest('.btn-view');
                                                populateViewModal(btn);
                                                
                                                // Show modal
                                                var viewModal = new bootstrap.Modal(document.getElementById('viewFarmerModal'));
                                                viewModal.show();
                                            }
                                        });

                                        // Function to populate view modal with farmer data
                                        function populateViewModal(btn) {
                                            // Basic Information
                                            document.getElementById('viewFullName').textContent = 
                                                `${btn.getAttribute('data-first_name') || ''} ${btn.getAttribute('data-middle_name') || ''} ${btn.getAttribute('data-last_name') || ''}`.trim();
                                            
                                            document.getElementById('viewUli').textContent = btn.getAttribute('data-uli') || 'Not assigned';
                                            document.getElementById('viewFirstName').textContent = btn.getAttribute('data-first_name') || '';
                                            document.getElementById('viewMiddleName').textContent = btn.getAttribute('data-middle_name') || '';
                                            document.getElementById('viewLastName').textContent = btn.getAttribute('data-last_name') || '';
                                            
                                            // Address Information
                                            document.getElementById('viewNumberStreet').textContent = btn.getAttribute('data-number_street') || 'Not specified';
                                            document.getElementById('viewBarangay').textContent = btn.getAttribute('data-barangay') || '';
                                            document.getElementById('viewDistrict').textContent = btn.getAttribute('data-district') || 'Not specified';
                                            document.getElementById('viewCityMunicipality').textContent = btn.getAttribute('data-city_municipality') || '';
                                            document.getElementById('viewProvince').textContent = btn.getAttribute('data-province') || '';
                                            document.getElementById('viewRegion').textContent = btn.getAttribute('data-region') || 'Not specified';
                                            
                                            // Contact Information
                                            document.getElementById('viewEmail').textContent = btn.getAttribute('data-email') || 'Not provided';
                                            document.getElementById('viewPhone').textContent = btn.getAttribute('data-phone') || '';
                                            document.getElementById('viewNationality').textContent = btn.getAttribute('data-nationality') || 'Filipino';
                                            
                                            // Personal Information
                                            document.getElementById('viewGender').textContent = btn.getAttribute('data-gender') || 'Not specified';
                                            
                                            const civilStatus = btn.getAttribute('data-civil_status');
                                            document.getElementById('viewCivilStatus').textContent = civilStatus ? formatText(civilStatus) : 'Not specified';
                                            
                                            const employmentStatus = btn.getAttribute('data-employment_status');
                                            document.getElementById('viewEmploymentStatus').textContent = employmentStatus ? formatEmploymentStatus(employmentStatus) : 'Not specified';
                                            
                                            // Birth Information
                                            const birthdate = btn.getAttribute('data-birthdate');
                                            document.getElementById('viewBirthdate').textContent = birthdate ? formatDate(birthdate) : 'Not specified';
                                            document.getElementById('viewAge').textContent = birthdate ? calculateAgeFromDate(birthdate) + ' years old' : 'Not specified';
                                            
                                            document.getElementById('viewBirthplaceCity').textContent = btn.getAttribute('data-birthplace_city') || 'Not specified';
                                            document.getElementById('viewBirthplaceProvince').textContent = btn.getAttribute('data-birthplace_province') || 'Not specified';
                                            document.getElementById('viewBirthplaceRegion').textContent = btn.getAttribute('data-birthplace_region') || 'Not specified';
                                            
                                            // Education Level
                                            const educationLevel = btn.getAttribute('data-education_level');
                                            document.getElementById('viewEducationLevel').textContent = educationLevel ? formatEducationLevel(educationLevel) : 'Not specified';
                                            
                                            // Classification
                                            const classification = btn.getAttribute('data-classification');
                                            document.getElementById('viewClassification').textContent = classification ? formatText(classification) : 'Not specified';
                                            
                                            // Profile Picture
                                            const profilePicture = btn.getAttribute('data-profile_picture');
                                            const profileImage = document.getElementById('viewProfileImage');
                                            if (profilePicture) {
                                                profileImage.src = `../../../uploads/profiles/${profilePicture}`;
                                                profileImage.alt = 'Profile Picture';
                                            } else {
                                                profileImage.src = 'https://via.placeholder.com/150x150/007bff/ffffff?text=No+Image';
                                                profileImage.alt = 'Default Profile Picture';
                                            }
                                        }

                                        // Helper functions for formatting
                                        function formatText(text) {
                                            return text.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                                        }

                                        function formatEmploymentStatus(status) {
                                            const statusMap = {
                                                'employed': 'Employed',
                                                'unemployed': 'Unemployed',
                                                'self-employed': 'Self-employed'
                                            };
                                            return statusMap[status] || formatText(status);
                                        }

                                        function formatEducationLevel(level) {
                                            const educationMap = {
                                                'no_grade': 'No Grade Completed/Pre-School',
                                                'elementary': 'Elementary Level',
                                                'elementary_grad': 'Elementary Graduate',
                                                'hs_level': 'High School Level',
                                                'hs_grad': 'High School Graduate',
                                                'post_secondary': 'Post-Secondary Level/Graduate',
                                                'college_level': 'College Level',
                                                'college_grad': 'College Graduate or Higher'
                                            };
                                            return educationMap[level] || formatText(level);
                                        }

                                        function formatDate(dateString) {
                                            const date = new Date(dateString);
                                            return date.toLocaleDateString('en-US', {
                                                year: 'numeric',
                                                month: 'long',
                                                day: 'numeric'
                                            });
                                        }

                                        function calculateAgeFromDate(birthdate) {
                                            const birthDate = new Date(birthdate);
                                            const today = new Date();
                                            let age = today.getFullYear() - birthDate.getFullYear();
                                            const monthDiff = today.getMonth() - birthDate.getMonth();
                                            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                                                age--;
                                            }
                                            return age;
                                        }

                                       // Print functionality for TESDA Registration Form
document.getElementById('printStudentBtn').addEventListener('click', function() {
    // Helper function to get text content safely
    function getTextContent(id) {
        const element = document.getElementById(id);
        return element ? element.textContent : '';
    }

    // Helper function to format date for birthdate fields
    function parseBirthdate(birthdate) {
        if (!birthdate) return { month: '', day: '', year: '' };
        const date = new Date(birthdate);
        return {
            month: date.toLocaleDateString('en-US', { month: 'long' }),
            day: date.getDate().toString(),
            year: date.getFullYear().toString()
        };
    }

    // Get birthdate components
    const birthdate = getTextContent('viewBirthdate');
    const birthdateParts = parseBirthdate(birthdate);

    // Get education level and check the appropriate checkbox
    const educationLevel = getTextContent('viewEducationLevel');
    const educationCheckboxes = {
        'No Grade Completed/Pre-School': 'no_grade',
        'Elementary Level': 'elementary',
        'Elementary Graduate': 'elementary_grad',
        'High School Level': 'hs_level',
        'High School Graduate': 'hs_grad',
        'Post-Secondary Level/Graduate': 'post_secondary',
        'College Level': 'college_level',
        'College Graduate or Higher': 'college_grad'
    };

    // Get classification and check the appropriate checkbox
    const classification = getTextContent('viewClassification');
    const classificationMap = {
        'Persons with Disabilities': 'pwd',
        'Displaced Worker': 'displaced',
        'OFW': 'ofw',
        'OFW Dependent': 'ofw_dependent',
        'OFW Repatriate': 'ofw_repatriate',
        'Victims/Survivors of Human Trafficking': 'trafficking',
        'Indigenous People': 'indigenous',
        'Rebel Returnees': 'rebel',
        'Solo Parent': 'solo_parent',
        'Others': 'others'
    };

    const printContent = `
<!DOCTYPE html>
<html>
<head>
    <title>Registration Form - ${getTextContent('viewFullName')}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px;
            font-size: 11pt;
        }
        .form-container {
            max-width: 210mm;
            margin: 0 auto;
            border: 2px solid #000;
        }
        .header {
            display: flex;
            align-items: center;
            border-bottom: 2px solid #000;
            padding: 10px;
        }
        .logo {
            width: 80px;
            height: 80px;
            border-right: 2px solid #000;
            padding-right: 10px;
            margin-right: 10px;
        }
        .header-text {
            flex: 1;
            text-align: center;
        }
        .header-text h3 {
            font-size: 12pt;
            margin-bottom: 3px;
        }
        .header-text h4 {
            font-size: 10pt;
            font-weight: normal;
        }
        .profile-photo {
            width: 120px;
            border-left: 2px solid #000;
            padding-left: 10px;
        }
        .profile-photo img {
            width: 100%;
            height: 140px;
            object-fit: cover;
        }
        .form-title {
            background-color: #e0e0e0;
            text-align: center;
            padding: 15px;
            border-bottom: 2px solid #000;
            font-size: 18pt;
            font-weight: bold;
        }
        .section-title {
            background-color: #f0f0f0;
            padding: 8px 10px;
            border-bottom: 2px solid #000;
            font-weight: bold;
            font-size: 11pt;
        }
        .form-section {
            border-bottom: 2px solid #000;
        }
        .form-row {
            display: flex;
            border-bottom: 1px solid #000;
        }
        .form-row:last-child {
            border-bottom: none;
        }
        .form-field {
            padding: 8px;
            border-right: 1px solid #000;
            flex: 1;
        }
        .form-field:last-child {
            border-right: none;
        }
        .field-label {
            font-size: 9pt;
            font-weight: bold;
            margin-bottom: 3px;
        }
        .field-value {
            font-size: 11pt;
            min-height: 20px;
        }
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .checkbox {
            width: 14px;
            height: 14px;
            border: 1px solid #000;
            display: inline-block;
        }
        .checkbox.checked::after {
            content: '';
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        .info-note {
            background-color: #f9f9f9;
            padding: 5px 10px;
            font-size: 9pt;
            font-style: italic;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table td {
            padding: 8px;
            border: 1px solid #000;
        }
        .education-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }
        .classification-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }
        @media print {
            body { padding: 0; }
            .no-print { display: none; }
            @page { margin: 10mm; }
        }
    </style>
</head>
<body>
    <div class="form-container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#000" stroke-width="2"/>
                    <circle cx="50" cy="50" r="35" fill="none" stroke="#000" stroke-width="2"/>
                    <text x="50" y="55" font-size="24" text-anchor="middle" font-weight="bold">TESDA</text>
                </svg>
            </div>
            <div class="header-text">
                <h3>Technical Education and Skills Development Authority</h3>
                <h4>Pangasiwaan sa Edukasyong Teknikal at Pagpapaunlad ng Kasanayan</h4>
            </div>
            <div class="profile-photo">
                <img src="${document.getElementById('viewProfileImage').src}" alt="Profile Photo">
            </div>
        </div>

        <!-- Form Title -->
        <div class="form-title">Registration Form</div>
        
        <div class="section-title">LEARNERS PROFILE FORM</div>

        <!-- Section 1: Web-Based Information System -->
        <div class="form-section">
            <div class="section-title">1. Web-Based Information System Auto Generated</div>
            <div class="form-row">
                <div class="form-field" style="flex: 2;">
                    <div class="field-label">1.1. Unique Learner Identifier (ULI) Number/Learner's ID:</div>
                    <div class="field-value">${getTextContent('viewUli')}</div>
                </div>
                <div class="form-field">
                    <div class="field-label">1.2. Entry Date:</div>
                    <div class="field-value">${new Date().toLocaleDateString()}</div>
                </div>
            </div>
        </div>

        <!-- Section 2: Manpower Profile -->
        <div class="form-section">
            <div class="section-title">2. Manpower Profile</div>
            <div class="form-row">
                <div class="form-field">
                    <div class="field-label">2.1. Name:</div>
                    <table style="margin-top: 5px;">
                        <tr>
                            <td style="width: 35%;">
                                <div class="field-label">Last</div>
                                <div class="field-value">${getTextContent('viewLastName')}</div>
                            </td>
                            <td style="width: 35%;">
                                <div class="field-label">First</div>
                                <div class="field-value">${getTextContent('viewFirstName')}</div>
                            </td>
                            <td style="width: 30%;">
                                <div class="field-label">Middle</div>
                                <div class="field-value">${getTextContent('viewMiddleName')}</div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="form-row">
                <div class="form-field" style="flex: 2;">
                    <div class="field-label">2.2. Complete Permanent Mailing Address:</div>
                    <table style="margin-top: 5px;">
                        <tr>
                            <td colspan="2">
                                <div class="field-label">Number, Street</div>
                                <div class="field-value">${getTextContent('viewNumberStreet')}</div>
                            </td>
                            <td>
                                <div class="field-label">District</div>
                                <div class="field-value">${getTextContent('viewDistrict')}</div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="field-label">Barangay</div>
                                <div class="field-value">${getTextContent('viewBarangay')}</div>
                            </td>
                            <td>
                                <div class="field-label">City/Municipality</div>
                                <div class="field-value">${getTextContent('viewCityMunicipality')}</div>
                            </td>
                            <td>
                                <div class="field-label">Region</div>
                                <div class="field-value">${getTextContent('viewRegion')}</div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="field-label">Province</div>
                                <div class="field-value">${getTextContent('viewProvince')}</div>
                            </td>
                            <td>
                                <div class="field-label">Email Address/Facebook Account</div>
                                <div class="field-value">${getTextContent('viewEmail')}</div>
                            </td>
                            <td>
                                <div class="field-label">Contact No.</div>
                                <div class="field-value">${getTextContent('viewPhone')}</div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- Section 3: Personal Information -->
        <div class="form-section">
            <div class="section-title">3. Personal Information</div>
            <div class="form-row">
                <div class="form-field">
                    <div class="field-label">3.1 Sex</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewGender') === 'Male' ? 'checked' : ''}"></span>
                            <span>Male</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewGender') === 'Female' ? 'checked' : ''}"></span>
                            <span>Female</span>
                        </div>
                    </div>
                </div>
                <div class="form-field">
                    <div class="field-label">3.2. Civil Status</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewCivilStatus') === 'Single' ? 'checked' : ''}"></span>
                            <span>Single</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewCivilStatus') === 'Married' ? 'checked' : ''}"></span>
                            <span>Married</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewCivilStatus') === 'Widower' ? 'checked' : ''}"></span>
                            <span>Widower</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewCivilStatus') === 'Separated' ? 'checked' : ''}"></span>
                            <span>Separated</span>
                        </div>
                    </div>
                </div>
                <div class="form-field">
                    <div class="field-label">3.3 Employment Status (before the training)</div>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewEmploymentStatus') === 'Employed' ? 'checked' : ''}"></span>
                            <span>Employed</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewEmploymentStatus') === 'Unemployed' ? 'checked' : ''}"></span>
                            <span>Unemployed</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${getTextContent('viewEmploymentStatus') === 'Self-employed' ? 'checked' : ''}"></span>
                            <span>Self-employed</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-field">
                    <div class="field-label">3.4 Birthdate</div>
                    <table style="margin-top: 5px;">
                        <tr>
                            <td>
                                <div class="field-label">Month of Birth</div>
                                <div class="field-value">${birthdateParts.month}</div>
                            </td>
                            <td>
                                <div class="field-label">Day of Birth</div>
                                <div class="field-value">${birthdateParts.day}</div>
                            </td>
                            <td>
                                <div class="field-label">Year of Birth</div>
                                <div class="field-value">${birthdateParts.year}</div>
                            </td>
                            <td>
                                <div class="field-label">Age</div>
                                <div class="field-value">${getTextContent('viewAge')}</div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="form-row">
                <div class="form-field">
                    <div class="field-label">3.4 Birthplace</div>
                    <table style="margin-top: 5px;">
                        <tr>
                            <td>
                                <div class="field-label">City/Municipality</div>
                                <div class="field-value">${getTextContent('viewBirthplaceCity')}</div>
                            </td>
                            <td>
                                <div class="field-label">Province</div>
                                <div class="field-value">${getTextContent('viewBirthplaceProvince')}</div>
                            </td>
                            <td>
                                <div class="field-label">Region</div>
                                <div class="field-value">${getTextContent('viewBirthplaceRegion')}</div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="form-row">
                <div class="form-field">
                    <div class="field-label">3.5 Educational Attainment (Before the Training)</div>
                    <div class="education-grid" style="margin-top: 5px;">
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'No Grade Completed/Pre-School' ? 'checked' : ''}"></span>
                            <span>No Grade Completed/ Pre-School</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'Elementary Level' ? 'checked' : ''}"></span>
                            <span>Elementary Level</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'Elementary Graduate' ? 'checked' : ''}"></span>
                            <span>Elementary Graduate</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'High School Level' ? 'checked' : ''}"></span>
                            <span>High School Level</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'High School Graduate' ? 'checked' : ''}"></span>
                            <span>High School Graduate</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'Post-Secondary Level/Graduate' ? 'checked' : ''}"></span>
                            <span>Post-Secondary Level/Graduate</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'College Level' ? 'checked' : ''}"></span>
                            <span>College Level</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${educationLevel === 'College Graduate or Higher' ? 'checked' : ''}"></span>
                            <span>College Graduate or Higher</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 4: Classification -->
        <div class="form-section">
            <div class="section-title">4. Learner/Trainee/Student (Clients) Classification:</div>
            <div class="form-row">
                <div class="form-field">
                    <div class="classification-grid">
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'Persons with Disabilities' ? 'checked' : ''}"></span>
                            <span>Persons with Disabilities (PWDs)</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'OFW Repatriate' ? 'checked' : ''}"></span>
                            <span>OFW Repatriate</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'Solo Parent' ? 'checked' : ''}"></span>
                            <span>Solo Parent</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'Displaced Worker' ? 'checked' : ''}"></span>
                            <span>Displaced Worker (Local)</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'Victims/Survivors of Human Trafficking' ? 'checked' : ''}"></span>
                            <span>Victims/Survivors of Human Trafficking</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'Others' ? 'checked' : ''}"></span>
                            <span>Others (pls. specify)</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'OFW' ? 'checked' : ''}"></span>
                            <span>OFW</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'Indigenous People' ? 'checked' : ''}"></span>
                            <span>Indigenous People & Cultural Communities</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox"></span>
                            <span></span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'OFW Dependent' ? 'checked' : ''}"></span>
                            <span>OFW Dependent</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox ${classification === 'Rebel Returnees' ? 'checked' : ''}"></span>
                            <span>Rebel Returnees</span>
                        </div>
                        <div class="checkbox-item">
                            <span class="checkbox"></span>
                            <span></span>
                        </div>
                    </div>
                    ${classification === 'Others' ? `
                    <div style="margin-top: 10px;">
                        <div class="field-label">Others Specification:</div>
                        <div class="field-value">${classification}</div>
                    </div>
                    ` : ''}
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="info-note no-print">
            <p>Printed on: ${new Date().toLocaleString()} | Generated by TESDA Registration System</p>
        </div>
    </div>
</body>
</html>
`;

    // Print the content
    const printWindow = window.open('', '_blank');
    printWindow.document.write(printContent);
    printWindow.document.close();
    printWindow.focus();

    setTimeout(() => {
        printWindow.print();
        printWindow.close();
    }, 250);
});


                                });
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Logout Confirmation Modal -->
    <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="logoutModalLabel">Confirm Logout</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            Are you sure you want to logout?
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <a href="../../../controllers/logout.php" class="btn btn-danger">Logout</a>
            </div>
        </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../assets/inside-auth.js"></script>
    <script src="../../assets/sidebar.js"></script>
    
</body>
</html>